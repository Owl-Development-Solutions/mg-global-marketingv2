<div class="space-y-6">
  @if (loading) {
    <!-- Loading State -->
    <div class="flex items-center justify-center py-12">
      <div class="text-center space-y-4">
        <mat-spinner color="warn" mode="indeterminate" diameter="50"></mat-spinner>
        <p class="text-sm text-gray-500 font-medium">Authenticating...</p>
      </div>
    </div>
  } @else {
    <!-- Login Form -->
    <form #authForm="ngForm" (ngSubmit)="login(authForm)" class="space-y-5">
      <!-- Email Field -->
      <div class="space-y-2">
        <mat-form-field 
          hideRequiredMarker 
          class="w-full"
        >
          <mat-label class="text-sm font-medium">Email Address</mat-label>
          <input
            required
            type="email"
            matInput
            placeholder="Enter your email"
            name="email"
            id="email"
            #email="ngModel"
            [(ngModel)]="input!.email"
            class="text-base"
          />

          @if (email.invalid && email.touched) {
            <mat-error class="text-sm">
              @if (email.hasError("required")) {
                <span>Email address is required</span>
              }
              @if (email.hasError("email")) {
                <span>Please enter a valid email address</span>
              }
            </mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Password Field -->
      <div class="space-y-2">
        <app-password-field
          #password="ngModel"
          name="password"
          [required]="true"
          [label]="'Password'"
          [isDisabled]="loading"
          [error]="password"
          [(ngModel)]="input!.password"
        >
        </app-password-field>
      </div>

      <!-- Action Links -->
      <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0 pt-2">
        <button
          type="button"
          (click)="forgottenPassword(authForm.value?.username)"
          class="text-sm font-medium text-gray-900 hover:text-gray-700 transition-colors duration-200 underline-offset-4 hover:underline"
        >
          Forgot Password?
        </button>

        <button
          type="button"
          (click)="signUpHere()"
          class="text-sm font-medium text-gray-900 hover:text-gray-700 transition-colors duration-200 underline-offset-4 hover:underline"
        >
          Register Here
        </button>
      </div>

      <!-- Submit Button -->
      <div class="pt-4">
        <app-submit-button
          [isDisabled]="authForm.invalid || authLoading()!"
          [isLoading]="authLoading()!"
          [text]="'Sign In'"
          [color]="'warn'"
        >
        </app-submit-button>
      </div>
    </form>
  }
</div>
